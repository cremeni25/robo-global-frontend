<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<title>Robô Global — Sistema Operacional</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="robots" content="noindex,nofollow"/>

<style>
:root{
--bg:#0b0f14;--fg:#e7ebf0;--muted:#9aa4b2;
--card:#0f172a;--border:#1b2742;
--ok:#20c997;--warn:#f59f00;--err:#ff6b6b;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,Arial}
header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;gap:12px;align-items:center}
main{padding:20px}
h1{margin:0;font-size:20px}
h2{margin:0 0 10px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
.card{background:linear-gradient(180deg,#0f172a,#0b1222);border:1px solid var(--border);border-radius:12px;padding:14px}
.kpi{font-size:22px;font-weight:700}
.muted{color:var(--muted)}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid var(--border);text-align:left;font-size:14px}
input,select{width:100%;padding:8px;margin-bottom:8px;background:#111827;border:1px solid var(--border);color:white;border-radius:6px}
button{padding:10px 16px;background:#2563eb;border:none;color:white;border-radius:6px;cursor:pointer}
button:hover{opacity:.9}
</style>
</head>

<body>

<header>
<h1>Dashboard Operacional</h1>
<span id="robotStatus">Carregando…</span>
</header>

<main>

<!-- CADASTRO OPERACIONAL -->
<section style="margin-bottom:20px">
<div class="card">
<h2>Cadastrar Produto (B2)</h2>

<input id="nomeProduto" placeholder="Nome do produto"/>
<select id="plataformaProduto">
<option value="Hotmart">Hotmart</option>
<option value="Eduzz">Eduzz</option>
<option value="Kiwify">Kiwify</option>
</select>
<input id="linkProduto" placeholder="Link de afiliado"/>

<button onclick="cadastrarProduto()">Cadastrar</button>

<div id="cadastroMsg" class="muted" style="margin-top:10px"></div>
</div>
</section>

<!-- PRODUTOS -->
<section>
<div class="card">
<h2>Produtos Cadastrados</h2>
<table>
<thead>
<tr>
<th>Produto</th>
<th>Plataforma</th>
<th>Receita</th>
<th>ROI</th>
<th>Risco</th>
<th>Status</th>
</tr>
</thead>
<tbody id="productsTable"></tbody>
</table>
</div>
</section>

</main>

<script>

const api = (p,opt={}) => fetch(p,opt).then(r=>r.json());

async function cadastrarProduto(){

const nome = document.getElementById("nomeProduto").value;
const plataforma = document.getElementById("plataformaProduto").value;
const link = document.getElementById("linkProduto").value;

if(!nome || !link){
document.getElementById("cadastroMsg").textContent="Preencha todos os campos.";
return;
}

try{
await fetch("/produtos",{
method:"POST",
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
nome:nome,
plataforma:plataforma,
link:link
})
});

document.getElementById("cadastroMsg").textContent="Produto cadastrado com sucesso.";
document.getElementById("nomeProduto").value="";
document.getElementById("linkProduto").value="";

loadProdutos();

}catch(e){
document.getElementById("cadastroMsg").textContent="Erro ao cadastrar.";
}
}

async function loadProdutos(){
try{
const produtos = await api("/produtos");

productsTable.innerHTML = produtos.map(p=>`
<tr>
<td>${p.nome}</td>
<td>${p.plataforma}</td>
<td>${p.receita ?? 0}</td>
<td>${p.roi ?? 0}</td>
<td>${p.risco ?? "—"}</td>
<td>${p.status ?? "ativo"}</td>
</tr>
`).join("");

}catch(e){
console.error(e);
}
}

loadProdutos();

</script>

</body>
</html>
